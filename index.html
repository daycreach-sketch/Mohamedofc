<script>
  // ====== LOGIN (identique) ======
  const PASSWORD = "3628363";
  const loginModal = document.getElementById("loginModal");
  const app = document.getElementById("app");
  const loginBtn = document.getElementById("loginBtn");
  const cancelBtn = document.getElementById("cancelBtn");
  const passInput = document.getElementById("passwordInput");
  const loginError = document.getElementById("loginError");

  function doLogin() {
    const pwd = (passInput.value || "").trim();
    if (pwd === PASSWORD) {
      loginModal.classList.add("hidden");
      app.classList.remove("hidden");
      app.focus();
    } else {
      loginError.textContent = "Senha incorreta!";
    }
  }
  loginBtn.addEventListener("click", doLogin);
  passInput.addEventListener("keydown", (e) => { if (e.key === "Enter") doLogin(); });
  cancelBtn.addEventListener("click", () => { passInput.value = ""; loginError.textContent = ""; passInput.focus(); });

  // ====== TABS (identique) ======
  const tabs = Array.from(document.querySelectorAll(".tab"));
  const panels = Array.from(document.querySelectorAll(".content"));
  tabs.forEach(tab => {
    tab.addEventListener("click", () => switchTab(tab));
    tab.addEventListener("keydown", (e) => { if (e.key === "Enter" || e.key === " ") switchTab(tab); });
  });
  function switchTab(activeTab) {
    tabs.forEach(t => {
      t.classList.toggle("active", t === activeTab);
      t.setAttribute("aria-selected", t === activeTab ? "true" : "false");
    });
    const targetId = activeTab.dataset.target;
    panels.forEach(p => {
      const isActive = p.id === targetId;
      p.classList.toggle("active", isActive);
      p.setAttribute("aria-hidden", isActive ? "false" : "true");
    });
  }

  // ====== SLIDER (identique) ======
  const fovRange = document.getElementById("fovRange");
  const fovValue = document.getElementById("fovValue");
  fovRange.addEventListener("input", function () {
    fovValue.textContent = "Fov " + this.value;
  });

  // ====== RADIO (identique) ======
  const radioGroup = document.getElementById("aimlockGroup");
  radioGroup.addEventListener("change", () => {
    const items = Array.from(radioGroup.querySelectorAll(".radio-item"));
    items.forEach(lbl => lbl.classList.remove("active"));
    const checked = radioGroup.querySelector('input[type="radio"]:checked');
    if (checked) checked.closest(".radio-item").classList.add("active");
  });

  // ============== OUVERTURE DE FREE FIRE (Android/iOS) ==============
  function isAndroid(){ return /Android/i.test(navigator.userAgent); }
  function isIOS(){ return /iPhone|iPad|iPod/i.test(navigator.userAgent); }

  const PLAY_URL = 'https://play.google.com/store/apps/details?id=com.dts.freefireth';
  const PLAY_URL_MAX = 'https://play.google.com/store/apps/details?id=com.dts.freefiremax';
  const IOS_URL  = 'https://apps.apple.com/app/id1300146617';

  function openAndroid() {
    // IMPORTANT: pas d’espaces/char spéciaux dans la chaîne intent !
    const intents = [
      'intent://launch/#Intent;scheme=freefire;package=com.dts.freefireth;S.browser_fallback_url=' +
        encodeURIComponent(PLAY_URL) + ';end',
      'intent://launch/#Intent;scheme=freefire;package=com.dts.freefiremax;S.browser_fallback_url=' +
        encodeURIComponent(PLAY_URL_MAX) + ';end'
    ];
    let redirected = false;
    const timer = setTimeout(()=>{ if(!redirected) window.location.href = PLAY_URL; }, 1200);
    // Tente l’intent principal, puis le MAX très vite après
    window.location.href = intents[0];
    setTimeout(()=>{ if(!redirected) window.location.href = intents[1]; }, 120);
    setTimeout(()=>{ redirected = true; clearTimeout(timer); }, 200);
  }

  function openIOS() {
    // Essais de schemes connus + fallback App Store
    const schemes = ['freefire://', 'garena://freefire'];
    let done = false;
    const timer = setTimeout(()=>{ if(!done) window.location.href = IOS_URL; }, 1200);

    (async ()=>{
      for (const s of schemes) {
        // iOS demande un geste utilisateur récent : on est dans le handler du bouton, donc OK.
        const ifr = document.createElement('iframe');
        ifr.style.display = 'none';
        ifr.src = s;
        document.body.appendChild(ifr);
        await new Promise(r => setTimeout(r, 150));
        try { document.body.removeChild(ifr); } catch(e){}
      }
      done = true; clearTimeout(timer);